# ‚úÖ –†–ï–ê–õ–¨–ù–ò–ô –†–û–ó–†–ê–•–£–ù–û–ö –í–Ü–î–°–¢–ê–ù–Ü –¢–ê –í–ê–†–¢–û–°–¢–Ü

## üéØ –©–û –í–ò–ü–†–ê–í–õ–ï–ù–û:

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
```python
distance_m = 5000  # 5 –∫–º –ó–ê–í–ñ–î–ò
duration_s = 600   # 10 —Ö–≤ –ó–ê–í–ñ–î–ò
fare = ~200 –≥—Ä–Ω    # –î–ª—è –±—É–¥—å-—è–∫–æ—ó –ø–æ—ó–∑–¥–∫–∏
```

### –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
```python
# Google Maps Distance Matrix API
distance_m = 450000  # 450 –∫–º (–ö—Ä–∏–≤–∏–π –†—ñ–≥ ‚Üí –ö–∏—ó–≤)
duration_s = 19200   # 320 —Ö–≤ (~5 –≥–æ–¥)
fare = ~5000 –≥—Ä–Ω     # –†–µ–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å
```

---

## üìä –ü–†–ò–ö–õ–ê–î–ò –†–û–ó–†–ê–•–£–ù–ö–Ü–í:

### –¢–∞—Ä–∏—Ñ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º):
```
–ë–∞–∑–æ–≤–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 50 –≥—Ä–Ω
–ó–∞ –∫—ñ–ª–æ–º–µ—Ç—Ä: 10 –≥—Ä–Ω/–∫–º
–ó–∞ —Ö–≤–∏–ª–∏–Ω—É: 2 –≥—Ä–Ω/—Ö–≤
–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 100 –≥—Ä–Ω
```

### –ü–æ—ó–∑–¥–∫–∞ 1: –ö—Ä–∏–≤–∏–π –†—ñ–≥ ‚Üí –ö–∏—ó–≤ (450 –∫–º)
```
–í—ñ–¥—Å—Ç–∞–Ω—å: 450 –∫–º
–ß–∞—Å: 320 —Ö–≤ (5 –≥–æ–¥)

–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:
= 50 (–±–∞–∑–æ–≤–∞) + 450√ó10 (–∫–º) + 320√ó2 (—Ö–≤)
= 50 + 4500 + 640
= 5190 –≥—Ä–Ω

–ö–æ–º—ñ—Å—ñ—è (2%): 103.8 –≥—Ä–Ω
–í–æ–¥—ñ–π –æ—Ç—Ä–∏–º—É—î: 5086.2 –≥—Ä–Ω
```

### –ü–æ—ó–∑–¥–∫–∞ 2: –ü–æ –º—ñ—Å—Ç—É (5 –∫–º)
```
–í—ñ–¥—Å—Ç–∞–Ω—å: 5 –∫–º
–ß–∞—Å: 15 —Ö–≤

–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:
= 50 + 5√ó10 + 15√ó2
= 50 + 50 + 30
= 130 –≥—Ä–Ω (–º—ñ–Ω—ñ–º—É–º: 100 –≥—Ä–Ω)

–ö–æ–º—ñ—Å—ñ—è (2%): 2.6 –≥—Ä–Ω
–í–æ–¥—ñ–π –æ—Ç—Ä–∏–º—É—î: 127.4 –≥—Ä–Ω
```

### –ü–æ—ó–∑–¥–∫–∞ 3: –ö—Ä–∏–≤–∏–π –†—ñ–≥ ‚Üí –î–Ω—ñ–ø—Ä–æ (85 –∫–º)
```
–í—ñ–¥—Å—Ç–∞–Ω—å: 85 –∫–º
–ß–∞—Å: 60 —Ö–≤

–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:
= 50 + 85√ó10 + 60√ó2
= 50 + 850 + 120
= 1020 –≥—Ä–Ω

–ö–æ–º—ñ—Å—ñ—è (2%): 20.4 –≥—Ä–Ω
–í–æ–¥—ñ–π –æ—Ç—Ä–∏–º—É—î: 999.6 –≥—Ä–Ω
```

---

## üîÑ –Ø–ö –¶–ï –ü–†–ê–¶–Æ–Ñ:

### 1. –ö–ª—ñ—î–Ω—Ç —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:

**–í–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å–∏:**
```
–ó–≤—ñ–¥–∫–∏: –ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1
–ö—É–¥–∏: –ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1
```

**–ë–æ—Ç –≥–µ–æ–∫–æ–¥—É—î –∞–¥—Ä–µ—Å–∏:**
```
Geocoding API:
"–ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1" 
  ‚Üí Lat: 47.9088, Lon: 33.3425

"–ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1"
  ‚Üí Lat: 50.4501, Lon: 30.5234
```

---

### 2. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Å—Ç–∞–Ω—ñ:

**Distance Matrix API:**
```
Origin: 47.9088, 33.3425
Destination: 50.4501, 30.5234

Response:
{
  "distance": {"value": 450300, "text": "450 km"},
  "duration": {"value": 19200, "text": "5 hours 20 mins"}
}
```

---

### 3. –ü–æ–∫–∞–∑ –∫–ª—ñ—î–Ω—Ç—É:

```
üìã –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:

üë§ –ö–ª—ñ—î–Ω—Ç: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ
üì± –¢–µ–ª–µ—Ñ–æ–Ω: +380501234567
üèô –ú—ñ—Å—Ç–æ: –ö—Ä–∏–≤–∏–π –†—ñ–≥

üìç –ó–≤—ñ–¥–∫–∏: –ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1
üìç –ö—É–¥–∏: –ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1
üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä: ‚Äî

üìè –í—ñ–¥—Å—Ç–∞–Ω—å: 450.3 –∫–º (~320 —Ö–≤)
üí∞ –û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 5190 –≥—Ä–Ω

–í—Å–µ –≤—ñ—Ä–Ω–æ?
```

---

### 4. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–æ–¥—ñ—è–º:

```
üîî –ù–û–í–ï –ó–ê–ú–û–í–õ–ï–ù–ù–Ø #123

üèô –ú—ñ—Å—Ç–æ: –ö—Ä–∏–≤–∏–π –†—ñ–≥
üë§ –ö–ª—ñ—î–Ω—Ç: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ
üì± –¢–µ–ª–µ—Ñ–æ–Ω: +380501234567

üìç –ó–≤—ñ–¥–∫–∏: –ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1
üìç –ö—É–¥–∏: –ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1
üìè –í—ñ–¥—Å—Ç–∞–Ω—å: 450.3 –∫–º (~320 —Ö–≤)
üí∞ –û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: ~5190 –≥—Ä–Ω

üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä: ‚Äî

‚è∞ –ß–∞—Å: 19:30

[‚úÖ –ü—Ä–∏–π–Ω—è—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è]
```

---

### 5. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–æ—ó–∑–¥–∫–∏:

**–í–æ–¥—ñ–π –Ω–∞—Ç–∏—Å–∫–∞—î "–ó–∞–≤–µ—Ä—à–∏—Ç–∏":**
```
‚úÖ –ü–æ—ó–∑–¥–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –í–∞—Ä—Ç—ñ—Å—Ç—å: 5190.00 –≥—Ä–Ω
```

**–ö–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º—É—î:**
```
‚úÖ –ü–æ—ó–∑–¥–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ!

üí∞ –í–∞—Ä—Ç—ñ—Å—Ç—å: 5190 –≥—Ä–Ω
üìç –í—ñ–¥—Å—Ç–∞–Ω—å: 450.3 –∫–º
‚è± –ß–∞—Å: 320 —Ö–≤

–ë—É–¥—å –ª–∞—Å–∫–∞, –æ—Ü—ñ–Ω—ñ—Ç—å –≤–æ–¥—ñ—è:
[‚≠êÔ∏è 5] [‚≠êÔ∏è 4] [‚≠êÔ∏è 3] [‚≠êÔ∏è 2] [‚≠êÔ∏è 1]
```

**–í–æ–¥—ñ–π –±–∞—á–∏—Ç—å:**
```
üí∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–∞—Ä–æ–±—ñ—Ç–∫—É

üíµ –ó–∞—Ä–æ–±—ñ—Ç–æ–∫ —Å—å–æ–≥–æ–¥–Ω—ñ: 5190.00 –≥—Ä–Ω
üí∏ –ö–æ–º—ñ—Å—ñ—è —Å—å–æ–≥–æ–¥–Ω—ñ: 103.80 –≥—Ä–Ω
üíö –ß–∏—Å—Ç–∏–π –∑–∞—Ä–æ–±—ñ—Ç–æ–∫: 5086.20 –≥—Ä–Ω

‚ö†Ô∏è –í—Å—å–æ–≥–æ –Ω–µ—Å–ø–ª–∞—á–µ–Ω–æ—ó –∫–æ–º—ñ—Å—ñ—ó: 103.80 –≥—Ä–Ω

–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: –°–ø–ª–∞—á—É–π—Ç–µ –∫–æ–º—ñ—Å—ñ—é —â–æ–¥–Ω—è –¥–æ 20:00
```

---

## üó∫Ô∏è –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø GOOGLE MAPS API:

**–û–±–æ–≤'—è–∑–∫–æ–≤–æ:** –ß–∏—Ç–∞–π—Ç–µ `GOOGLE_MAPS_SETUP.md`

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç:

1. **Google Cloud Console** ‚Üí https://console.cloud.google.com
2. Create Project ‚Üí "Taxi Bot"
3. Enable APIs:
   - Distance Matrix API
   - Geocoding API
4. Create Credentials ‚Üí API Key
5. Copy key: `AIzaSyD...`
6. **Render Dashboard** ‚Üí Environment:
   ```
   GOOGLE_MAPS_API_KEY=AIzaSyD...
   ```
7. Save & Redeploy

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä –≤—ñ–¥—Å—Ç–∞–Ω—å —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

---

## ‚öôÔ∏è –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –¢–ê–†–ò–§–Ü–í:

### –ß–µ—Ä–µ–∑ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å:

```
/admin ‚Üí –¢–∞—Ä–∏—Ñ–∏ ‚Üí –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π

–ë–∞–∑–æ–≤–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 50 –≥—Ä–Ω
–ó–∞ –∫—ñ–ª–æ–º–µ—Ç—Ä: 10 –≥—Ä–Ω/–∫–º
–ó–∞ —Ö–≤–∏–ª–∏–Ω—É: 2 –≥—Ä–Ω/—Ö–≤
–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 100 –≥—Ä–Ω

‚úÖ –°—Ç–≤–æ—Ä–∏—Ç–∏
```

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ —Ç–∞—Ä–∏—Ñ–∏:

**–î–ª—è –º—ñ—Å—Ç–∞ (–∫–æ—Ä–æ—Ç–∫—ñ –ø–æ—ó–∑–¥–∫–∏):**
```
–ë–∞–∑–æ–≤–∞: 30 –≥—Ä–Ω
–ö–º: 8 –≥—Ä–Ω/–∫–º
–•–≤: 3 –≥—Ä–Ω/—Ö–≤
–ú—ñ–Ω—ñ–º—É–º: 50 –≥—Ä–Ω

–ü—Ä–∏–∫–ª–∞–¥: 3 –∫–º, 10 —Ö–≤
= 30 + 3√ó8 + 10√ó3
= 30 + 24 + 30
= 84 –≥—Ä–Ω
```

**–î–ª—è –º—ñ–∂–º—ñ—Å—å–∫–∏—Ö (–¥–æ–≤–≥—ñ –ø–æ—ó–∑–¥–∫–∏):**
```
–ë–∞–∑–æ–≤–∞: 100 –≥—Ä–Ω
–ö–º: 12 –≥—Ä–Ω/–∫–º
–•–≤: 1 –≥—Ä–Ω/—Ö–≤ (–º–µ–Ω—à–µ, –±–æ –±—ñ–ª—å—à–µ —á–∞—Å—É)
–ú—ñ–Ω—ñ–º—É–º: 200 –≥—Ä–Ω

–ü—Ä–∏–∫–ª–∞–¥: 450 –∫–º, 320 —Ö–≤
= 100 + 450√ó12 + 320√ó1
= 100 + 5400 + 320
= 5820 –≥—Ä–Ω
```

**–î–ª—è –ø—Ä–µ–º—ñ—É–º:**
```
–ë–∞–∑–æ–≤–∞: 150 –≥—Ä–Ω
–ö–º: 20 –≥—Ä–Ω/–∫–º
–•–≤: 5 –≥—Ä–Ω/—Ö–≤
–ú—ñ–Ω—ñ–º—É–º: 300 –≥—Ä–Ω
```

---

## üîß FALLBACK (–ë–ï–ó API):

–Ø–∫—â–æ Google Maps API –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π:

```python
# app/handlers/driver_panel.py
distance_m = order.distance_m if order.distance_m else 5000  # fallback
duration_s = order.duration_s if order.duration_s else 600   # fallback
```

**–©–æ –ø—Ä–∞—Ü—é—î:**
- ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
- ‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è
- ‚úÖ –í–æ–¥—ñ—ó –ø—Ä–∏–π–º–∞—é—Ç—å
- ‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –ø—Ä–∞—Ü—é—î

**–©–æ –ù–ï –ø—Ä–∞—Ü—é—î:**
- ‚ùå –í—ñ–¥—Å—Ç–∞–Ω—å –∑–∞–≤–∂–¥–∏ 5 –∫–º
- ‚ùå –í–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞–≤–∂–¥–∏ ~200 –≥—Ä–Ω
- ‚ùå –¢–µ–∫—Å—Ç–æ–≤—ñ –∞–¥—Ä–µ—Å–∏ –Ω–µ –≥–µ–æ–∫–æ–¥—É—é—Ç—å—Å—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ù–∞–ª–∞—à—Ç—É–π—Ç–µ API –¥–ª—è —Ç–æ—á–Ω–∏—Ö —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤!

---

## üìä –ú–û–ù–Ü–¢–û–†–ò–ù–ì:

### –í –ª–æ–≥–∞—Ö Render:

```
INFO - –ì–µ–æ–∫–æ–¥–æ–≤–∞–Ω–æ –∞–¥—Ä–µ—Å—É: –ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1 ‚Üí 47.9088,33.3425
INFO - –ì–µ–æ–∫–æ–¥–æ–≤–∞–Ω–æ –∞–¥—Ä–µ—Å—É: –ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1 ‚Üí 50.4501,30.5234
INFO - Order #123: Distance=450.3km, Duration=320min, Fare=5190.00–≥—Ä–Ω
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤ –ë–î:

```sql
SELECT 
    id, 
    pickup_address, 
    destination_address,
    distance_m / 1000.0 as km,
    duration_s / 60 as minutes,
    fare_amount
FROM orders 
WHERE id = 123;

-- –†–µ–∑—É–ª—å—Ç–∞—Ç:
-- id: 123
-- pickup_address: –ö—Ä–∏–≤–∏–π –†—ñ–≥, –≤—É–ª. –°–æ–±–æ—Ä–Ω–æ—Å—Ç—ñ 1
-- destination_address: –ö–∏—ó–≤, –•—Ä–µ—â–∞—Ç–∏–∫ 1
-- km: 450.3
-- minutes: 320
-- fare_amount: 5190.00
```

---

## ‚úÖ –ü–Ü–î–°–£–ú–û–ö:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è | –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è |
|----------|----------------|-------------------|
| **–í—ñ–¥—Å—Ç–∞–Ω—å** | 5 –∫–º (–∑–∞–≤–∂–¥–∏) | 450 –∫–º (—Ä–µ–∞–ª—å–Ω–æ) |
| **–ß–∞—Å** | 10 —Ö–≤ (–∑–∞–≤–∂–¥–∏) | 320 —Ö–≤ (—Ä–µ–∞–ª—å–Ω–æ) |
| **–í–∞—Ä—Ç—ñ—Å—Ç—å** | ~200 –≥—Ä–Ω | ~5190 –≥—Ä–Ω |
| **–ü–æ–∫–∞–∑ –∫–ª—ñ—î–Ω—Ç—É** | –ù—ñ | ‚úÖ –¢–∞–∫ |
| **–ü–æ–∫–∞–∑ –≤–æ–¥—ñ—é** | –ù—ñ | ‚úÖ –¢–∞–∫ |
| **–ì–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è** | –ù—ñ | ‚úÖ –¢–∞–∫ |

---

## üéØ –ù–ê–°–¢–£–ü–ù–Ü –ö–†–û–ö–ò:

1. ‚úÖ –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Google Maps API (`GOOGLE_MAPS_SETUP.md`)
2. ‚úÖ –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–∞—Ä–∏—Ñ —á–µ—Ä–µ–∑ /admin
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:
   - –ö–æ—Ä–æ—Ç–∫–∞ –ø–æ—ó–∑–¥–∫–∞ (5 –∫–º) ‚Üí ~130 –≥—Ä–Ω
   - –î–æ–≤–≥–∞ –ø–æ—ó–∑–¥–∫–∞ (450 –∫–º) ‚Üí ~5190 –≥—Ä–Ω
4. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render
5. ‚úÖ –ì–æ—Ç–æ–≤–æ! –ë–æ—Ç –ø—Ä–∞—Ü—é—î –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∞–º–∏

**–¢–µ–ø–µ—Ä –∫–æ–∂–µ–Ω –∫—ñ–ª–æ–º–µ—Ç—Ä –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è!** üéâ
