# üóÑÔ∏è –Ü–ù–°–¢–†–£–ö–¶–Ü–Ø: –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö

**–Ø–∫ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω–∏–º–∏ –≤ PostgreSQL (Render) —Ç–∞ SQLite (–ª–æ–∫–∞–ª—å–Ω–æ)**

---

## üìã –ó–ú–Ü–°–¢

1. [–ß–µ—Ä–µ–∑ Render Dashboard (PostgreSQL)](#1-—á–µ—Ä–µ–∑-render-dashboard-postgresql)
2. [–ß–µ—Ä–µ–∑ SQL –∫–ª—ñ—î–Ω—Ç (DBeaver, pgAdmin)](#2-—á–µ—Ä–µ–∑-sql-–∫–ª—ñ—î–Ω—Ç-dbeaver-pgadmin)
3. [–ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ (psql, sqlite3)](#3-—á–µ—Ä–µ–∑-–∫–æ–º–∞–Ω–¥–Ω–∏–π-—Ä—è–¥–æ–∫-psql-sqlite3)
4. [–ß–µ—Ä–µ–∑ –∫–æ–¥ –±–æ—Ç–∞ (–¥–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å)](#4-—á–µ—Ä–µ–∑-–∫–æ–¥-–±–æ—Ç–∞-–∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å)
5. [–ö–æ—Ä–∏—Å–Ω—ñ SQL –∑–∞–ø–∏—Ç–∏](#5-–∫–æ—Ä–∏—Å–Ω—ñ-sql-–∑–∞–ø–∏—Ç–∏)

---

## 1Ô∏è‚É£ –ß–µ—Ä–µ–∑ Render Dashboard (PostgreSQL)

### –°–ø–æ—Å—ñ–± 1: Web Shell

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Render Dashboard](https://dashboard.render.com/)
2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à—É **PostgreSQL** –±–∞–∑—É
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Connect** ‚Üí **External Connection**
4. –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ **psql** –∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É (—è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–æ)

**‚ö†Ô∏è –ü—Ä–∏–º—ñ—Ç–∫–∞:** Render Free tier –º–∞—î –æ–±–º–µ–∂–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—ñ.

---

## 2Ô∏è‚É£ –ß–µ—Ä–µ–∑ SQL –∫–ª—ñ—î–Ω—Ç (DBeaver, pgAdmin)

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Å–ø–æ—Å—ñ–±: DBeaver (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π, –∑—Ä—É—á–Ω–∏–π)

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DBeaver

**Windows/Mac/Linux:**
```bash
# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ —Å–∞–π—Ç—É:
https://dbeaver.io/download/
```

**Ubuntu/Debian:**
```bash
sudo snap install dbeaver-ce
```

**macOS (Homebrew):**
```bash
brew install --cask dbeaver-community
```

#### –ö—Ä–æ–∫ 2: –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ PostgreSQL (Render)

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ DBeaver
2. **Database** ‚Üí **New Database Connection**
3. –û–±–µ—Ä—ñ—Ç—å **PostgreSQL**
4. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –¥–∞–Ω—ñ –∑ Render:

**–û—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
- Render Dashboard ‚Üí PostgreSQL Database ‚Üí **Info**

**–ó–∞–ø–æ–≤–Ω–∏—Ç–∏ —Ñ–æ—Ä–º—É:**
```
Host: dpg-xxxxx.oregon-postgres.render.com
Port: 5432
Database: taxi_bot (–≤–∞—à–∞ –Ω–∞–∑–≤–∞)
Username: taxi_bot_user (–∑ Render)
Password: (–∑ Render)

SSL: Enabled (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–ª—è Render!)
```

5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Test Connection** ‚Üí –º–∞—î –±—É—Ç–∏ —É—Å–ø—ñ—à–Ω–æ
6. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Finish**

#### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–∞–Ω—ñ

1. –†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å –∑'—î–¥–Ω–∞–Ω–Ω—è –≤ –ª—ñ–≤—ñ–π –ø–∞–Ω–µ–ª—ñ
2. **Databases** ‚Üí **your_database** ‚Üí **Schemas** ‚Üí **public** ‚Üí **Tables**
3. –ü—Ä–∞–≤–∞ –∫–Ω–æ–ø–∫–∞ –Ω–∞ —Ç–∞–±–ª–∏—Ü—ñ ‚Üí **View Data**

#### –ö—Ä–æ–∫ 4: –í–∏–¥–∞–ª–∏—Ç–∏ –¥–∞–Ω—ñ

**–°–ø–æ—Å—ñ–± A: –ß–µ—Ä–µ–∑ SQL –∑–∞–ø–∏—Ç**
1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **SQL Editor** (–∞–±–æ Ctrl+])
2. –ù–∞–ø–∏—à—ñ—Ç—å –∑–∞–ø–∏—Ç (–¥–∏–≤. —Ä–æ–∑–¥—ñ–ª 5)
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Execute** (Ctrl+Enter)

**–°–ø–æ—Å—ñ–± B: –ß–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
1. –ü—Ä–∞–≤–∞ –∫–Ω–æ–ø–∫–∞ –Ω–∞ —Ç–∞–±–ª–∏—Ü—ñ ‚Üí **View Data**
2. –û–±–µ—Ä—ñ—Ç—å —Ä—è–¥–æ–∫(–∏) –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Delete** –∞–±–æ –ø—Ä–∞–≤–∞ –∫–Ω–æ–ø–∫–∞ ‚Üí **Delete**
4. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å

---

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: pgAdmin

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:**
```bash
# Ubuntu/Debian
sudo apt install pgadmin4

# macOS
brew install --cask pgadmin4

# Windows
# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑: https://www.pgadmin.org/download/
```

**–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ pgAdmin
2. **Servers** ‚Üí –ø—Ä–∞–≤–∞ –∫–Ω–æ–ø–∫–∞ ‚Üí **Register** ‚Üí **Server**
3. **General** ‚Üí Name: Render PostgreSQL
4. **Connection** ‚Üí –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –¥–∞–Ω—ñ –∑ Render (—è–∫ –≤ DBeaver)
5. **Save**

---

## 3Ô∏è‚É£ –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫

### PostgreSQL (Render)

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ psql

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install postgresql-client
```

**macOS:**
```bash
brew install libpq
echo 'export PATH="/usr/local/opt/libpq/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

**Windows:**
–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑: https://www.postgresql.org/download/windows/

#### –ö—Ä–æ–∫ 2: –û—Ç—Ä–∏–º–∞—Ç–∏ External Database URL

1. Render Dashboard ‚Üí PostgreSQL Database
2. **Connections** ‚Üí **External Database URL**
3. –°–∫–æ–ø—ñ—é–π—Ç–µ URL:
```
postgres://user:password@dpg-xxxxx.oregon-postgres.render.com:5432/database
```

#### –ö—Ä–æ–∫ 3: –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è

```bash
# –ó–∞–º—ñ–Ω—ñ—Ç—å URL –Ω–∞ –≤–∞—à:
psql "postgres://user:password@dpg-xxxxx.oregon-postgres.render.com:5432/database"

# –ê–±–æ –æ–∫—Ä–µ–º–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
psql -h dpg-xxxxx.oregon-postgres.render.com \
     -U taxi_bot_user \
     -d taxi_bot \
     -p 5432
# –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å
```

#### –ö—Ä–æ–∫ 4: –í–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏

```sql
-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ
\dt

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ
\d orders

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–∞–Ω—ñ
SELECT * FROM orders LIMIT 10;

-- –í–∏–¥–∞–ª–∏—Ç–∏ –¥–∞–Ω—ñ (–¥–∏–≤. —Ä–æ–∑–¥—ñ–ª 5)
DELETE FROM orders WHERE status = 'cancelled';

-- –í–∏–π—Ç–∏
\q
```

---

### SQLite (–ª–æ–∫–∞–ª—å–Ω–æ)

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ sqlite3

**Ubuntu/Debian:**
```bash
sudo apt install sqlite3
```

**macOS:**
```bash
brew install sqlite3
```

**Windows:**
–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑: https://www.sqlite.org/download.html

#### –ö—Ä–æ–∫ 2: –í—ñ–¥–∫—Ä–∏—Ç–∏ –±–∞–∑—É

```bash
# –ó –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç—É:
sqlite3 data/taxi.sqlite3
```

#### –ö—Ä–æ–∫ 3: –í–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏

```sql
-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ
.tables

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
.schema orders

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–∞–Ω—ñ
SELECT * FROM orders LIMIT 10;

-- –í–∏–¥–∞–ª–∏—Ç–∏ –¥–∞–Ω—ñ
DELETE FROM orders WHERE status = 'cancelled';

-- –í–∏–π—Ç–∏
.quit
```

---

## 4Ô∏è‚É£ –ß–µ—Ä–µ–∑ –∫–æ–¥ –±–æ—Ç–∞ (–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å)

### –î–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å

–°—Ç–≤–æ—Ä—é –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤ `app/handlers/admin.py`:

```python
@router.message(F.text == "üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –¥–∞–Ω—ñ")
async def clear_data_menu(message: Message) -> None:
    """–ú–µ–Ω—é –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
    if not message.from_user or not is_admin(message.from_user.id):
        return
    
    kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è", callback_data="clear:old_orders")],
        [InlineKeyboardButton(text="üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ —Å–∫–∞—Å–æ–≤–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è", callback_data="clear:cancelled_orders")],
        [InlineKeyboardButton(text="üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–∏—Ö –≤–æ–¥—ñ—ó–≤", callback_data="clear:rejected_drivers")],
        [InlineKeyboardButton(text="‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è", callback_data="clear:all_orders")],
        [InlineKeyboardButton(text="‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏", callback_data="clear:cancel")],
    ])
    
    await message.answer(
        "üóëÔ∏è <b>–û—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</b>\n\n"
        "‚ö†Ô∏è <b>–£–í–ê–ì–ê:</b> –í–∏–¥–∞–ª–µ–Ω—ñ –¥–∞–Ω—ñ –Ω–µ–º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏!\n\n"
        "–û–±–µ—Ä—ñ—Ç—å —â–æ –≤–∏–¥–∞–ª–∏—Ç–∏:",
        reply_markup=kb
    )

@router.callback_query(F.data.startswith("clear:"))
async def handle_clear_data(call: CallbackQuery) -> None:
    """–û–±—Ä–æ–±–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
    if not call.from_user or not is_admin(call.from_user.id):
        await call.answer("‚ùå –ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É")
        return
    
    action = call.data.split(":")[1]
    
    if action == "cancel":
        await call.message.delete()
        await call.answer("–°–∫–∞—Å–æ–≤–∞–Ω–æ")
        return
    
    from app.storage.db_connection import db_manager
    
    try:
        async with db_manager.connect(config.database_path) as db:
            if action == "old_orders":
                # –í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä—à—ñ 30 –¥–Ω—ñ–≤
                await db.execute("""
                    DELETE FROM orders 
                    WHERE created_at < datetime('now', '-30 days')
                """)
                count = await db.execute("SELECT changes()")
                result = await count.fetchone()
                deleted = result[0] if result else 0
                await db.commit()
                
                await call.answer(f"‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ {deleted} —Å—Ç–∞—Ä–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å")
                await call.message.edit_text(
                    f"‚úÖ <b>–í–∏–¥–∞–ª–µ–Ω–æ –∑–∞–º–æ–≤–ª–µ–Ω—å:</b> {deleted}\n\n"
                    f"–í–∏–¥–∞–ª–µ–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä—à—ñ 30 –¥–Ω—ñ–≤"
                )
            
            elif action == "cancelled_orders":
                # –í–∏–¥–∞–ª–∏—Ç–∏ —Å–∫–∞—Å–æ–≤–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                await db.execute("""
                    DELETE FROM orders 
                    WHERE status = 'cancelled'
                """)
                count = await db.execute("SELECT changes()")
                result = await count.fetchone()
                deleted = result[0] if result else 0
                await db.commit()
                
                await call.answer(f"‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ {deleted} —Å–∫–∞—Å–æ–≤–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å")
                await call.message.edit_text(
                    f"‚úÖ <b>–í–∏–¥–∞–ª–µ–Ω–æ –∑–∞–º–æ–≤–ª–µ–Ω—å:</b> {deleted}\n\n"
                    f"–í–∏–¥–∞–ª–µ–Ω—ñ –≤—Å—ñ —Å–∫–∞—Å–æ–≤–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"
                )
            
            elif action == "rejected_drivers":
                # –í–∏–¥–∞–ª–∏—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–∏—Ö –≤–æ–¥—ñ—ó–≤
                await db.execute("""
                    DELETE FROM drivers 
                    WHERE status = 'rejected'
                """)
                count = await db.execute("SELECT changes()")
                result = await count.fetchone()
                deleted = result[0] if result else 0
                await db.commit()
                
                await call.answer(f"‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ {deleted} –≤—ñ–¥—Ö–∏–ª–µ–Ω–∏—Ö –≤–æ–¥—ñ—ó–≤")
                await call.message.edit_text(
                    f"‚úÖ <b>–í–∏–¥–∞–ª–µ–Ω–æ –≤–æ–¥—ñ—ó–≤:</b> {deleted}\n\n"
                    f"–í–∏–¥–∞–ª–µ–Ω—ñ –≤—Å—ñ –≤—ñ–¥—Ö–∏–ª–µ–Ω—ñ –∑–∞—è–≤–∫–∏"
                )
            
            elif action == "all_orders":
                # –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
                kb = InlineKeyboardMarkup(inline_keyboard=[
                    [InlineKeyboardButton(text="‚ö†Ô∏è –¢–ê–ö, –≤–∏–¥–∞–ª–∏—Ç–∏ –í–°–ï", callback_data="clear:confirm_all")],
                    [InlineKeyboardButton(text="‚ùå –ù–Ü, —Å–∫–∞—Å—É–≤–∞—Ç–∏", callback_data="clear:cancel")],
                ])
                
                await call.message.edit_text(
                    "‚ö†Ô∏è <b>–£–í–ê–ì–ê!</b>\n\n"
                    "–í–∏ –∑–±–∏—Ä–∞—î—Ç–µ—Å—å –≤–∏–¥–∞–ª–∏—Ç–∏ <b>–í–°–Ü</b> –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö!\n\n"
                    "–¶–µ –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è. –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ?",
                    reply_markup=kb
                )
                await call.answer()
            
            elif action == "confirm_all":
                # –í–∏–¥–∞–ª–∏—Ç–∏ –í–°–Ü –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                count_query = await db.execute("SELECT COUNT(*) FROM orders")
                total = (await count_query.fetchone())[0]
                
                await db.execute("DELETE FROM orders")
                await db.commit()
                
                await call.answer("‚úÖ –í—Å—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–æ")
                await call.message.edit_text(
                    f"‚úÖ <b>–í–∏–¥–∞–ª–µ–Ω–æ –≤—Å—ñ—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å:</b> {total}\n\n"
                    f"–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å –æ—á–∏—â–µ–Ω–∞"
                )
    
    except Exception as e:
        logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: {e}")
        await call.answer("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è")
        await call.message.edit_text(
            f"‚ùå <b>–ü–æ–º–∏–ª–∫–∞:</b>\n\n{str(e)}"
        )
```

**–î–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é –∞–¥–º—ñ–Ω–∞:**

```python
def admin_menu_keyboard() -> ReplyKeyboardMarkup:
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"), KeyboardButton(text="üë• –ú–æ–¥–µ—Ä–∞—Ü—ñ—è –≤–æ–¥—ñ—ó–≤")],
            [KeyboardButton(text="üí∞ –¢–∞—Ä–∏—Ñ–∏"), KeyboardButton(text="üöó –í–æ–¥—ñ—ó")],
            [KeyboardButton(text="üì¢ –†–æ–∑—Å–∏–ª–∫–∞"), KeyboardButton(text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –¥–∞–Ω—ñ")],  # ‚Üê –î–û–î–ê–ù–û
        ],
        resize_keyboard=True,
    )
```

---

## 5Ô∏è‚É£ –ö–æ—Ä–∏—Å–Ω—ñ SQL –∑–∞–ø–∏—Ç–∏

### –ü–µ—Ä–µ–≥–ª—è–¥ –¥–∞–Ω–∏—Ö

```sql
-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public';  -- PostgreSQL

.tables  -- SQLite

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ
\d orders  -- PostgreSQL
.schema orders  -- SQLite

-- –ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å–∏
SELECT COUNT(*) FROM orders;
SELECT COUNT(*) FROM drivers;
SELECT COUNT(*) FROM users;

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 10 –∑–∞–º–æ–≤–ª–µ–Ω—å
SELECT * FROM orders 
ORDER BY created_at DESC 
LIMIT 10;

-- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º
SELECT status, COUNT(*) as count 
FROM orders 
GROUP BY status;
```

---

### –í–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

#### ‚ö†Ô∏è –ë–ï–ó–ü–ï–ß–ù–Ü –∑–∞–ø–∏—Ç–∏ (–∑ —É–º–æ–≤–∞–º–∏)

```sql
-- –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (>30 –¥–Ω—ñ–≤)
DELETE FROM orders 
WHERE created_at < NOW() - INTERVAL '30 days';  -- PostgreSQL

DELETE FROM orders 
WHERE created_at < datetime('now', '-30 days');  -- SQLite

-- –í–∏–¥–∞–ª–∏—Ç–∏ —Å–∫–∞—Å–æ–≤–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
DELETE FROM orders 
WHERE status = 'cancelled';

-- –í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä—à—ñ 60 –¥–Ω—ñ–≤
DELETE FROM orders 
WHERE status = 'completed' 
AND created_at < NOW() - INTERVAL '60 days';  -- PostgreSQL

-- –í–∏–¥–∞–ª–∏—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–∏—Ö –≤–æ–¥—ñ—ó–≤
DELETE FROM drivers 
WHERE status = 'rejected';

-- –í–∏–¥–∞–ª–∏—Ç–∏ –≤–æ–¥—ñ—ó–≤ —è–∫—ñ –Ω–µ –æ–Ω–ª–∞–π–Ω >90 –¥–Ω—ñ–≤
DELETE FROM drivers 
WHERE status = 'approved' 
AND online = 0 
AND updated_at < NOW() - INTERVAL '90 days';  -- PostgreSQL

-- –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –±–µ–∑ –∑–∞–º–æ–≤–ª–µ–Ω—å
DELETE FROM users 
WHERE user_id NOT IN (SELECT DISTINCT user_id FROM orders);

-- –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
DELETE FROM orders 
WHERE user_id = 123456789;  -- –≤–∞—à —Ç–µ—Å—Ç–æ–≤–∏–π ID
```

---

#### ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è –ù–ï–ë–ï–ó–ü–ï–ß–ù–Ü –∑–∞–ø–∏—Ç–∏ (–≤–∏–¥–∞–ª—è—é—Ç—å –í–°–ï!)

```sql
-- ‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
DELETE FROM orders;

-- ‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü–• –≤–æ–¥—ñ—ó–≤
DELETE FROM drivers;

-- ‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–ò –í–°–Ü–• –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
DELETE FROM users;

-- ‚ö†Ô∏è –û–ß–ò–°–¢–ò–¢–ò —Ç–∞–±–ª–∏—Ü—é —ñ —Å–∫–∏–Ω—É—Ç–∏ counter
TRUNCATE TABLE orders;  -- PostgreSQL
DELETE FROM orders; DELETE FROM sqlite_sequence WHERE name='orders';  -- SQLite

-- ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–ò —Ç–∞–±–ª–∏—Ü—é –ü–û–í–ù–Ü–°–¢–Æ
DROP TABLE orders;  -- –ù–ï –í–ò–ö–û–†–ò–°–¢–û–í–£–ô–¢–ï –ë–ï–ó –ù–ï–û–ë–•–Ü–î–ù–û–°–¢–Ü!
```

**‚ö†Ô∏è –£–í–ê–ì–ê:** –ó–∞–≤–∂–¥–∏ —Ä–æ–±—ñ—Ç—å backup –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –±–∞–≥–∞—Ç—å–æ—Ö –¥–∞–Ω–∏—Ö!

---

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

```sql
-- –ó–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
UPDATE orders 
SET status = 'cancelled' 
WHERE id = 123;

-- –î–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –≤–æ–¥—ñ—è
UPDATE drivers 
SET online = 0 
WHERE tg_user_id = 123456789;

-- –°–∫–∏–Ω—É—Ç–∏ —Ä–µ–π—Ç–∏–Ω–≥ –≤–æ–¥—ñ—è
UPDATE drivers 
SET rating = 5.0, ratings_count = 0 
WHERE id = 42;

-- –ó–º—ñ–Ω–∏—Ç–∏ —Ç–∞—Ä–∏—Ñ –¥–ª—è –≤—Å—ñ—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å
UPDATE orders 
SET fare_amount = fare_amount * 1.1 
WHERE status = 'pending';
```

---

### Backup –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º

#### PostgreSQL (pg_dump)

```bash
# –ó—Ä–æ–±–∏—Ç–∏ –ø–æ–≤–Ω–∏–π backup
pg_dump -h dpg-xxxxx.oregon-postgres.render.com \
        -U taxi_bot_user \
        -d taxi_bot \
        -F c \
        -f backup_$(date +%Y%m%d).dump

# –ó—Ä–æ–±–∏—Ç–∏ backup —Ç—ñ–ª—å–∫–∏ –¥–∞–Ω–∏—Ö (–±–µ–∑ —Å—Ö–µ–º–∏)
pg_dump -h dpg-xxxxx.oregon-postgres.render.com \
        -U taxi_bot_user \
        -d taxi_bot \
        --data-only \
        -f data_backup_$(date +%Y%m%d).sql

# –ó—Ä–æ–±–∏—Ç–∏ backup –æ–¥–Ω—ñ—î—ó —Ç–∞–±–ª–∏—Ü—ñ
pg_dump -h dpg-xxxxx.oregon-postgres.render.com \
        -U taxi_bot_user \
        -d taxi_bot \
        -t orders \
        -f orders_backup_$(date +%Y%m%d).sql
```

#### SQLite

```bash
# –ó—Ä–æ–±–∏—Ç–∏ –ø–æ–≤–Ω–∏–π backup
sqlite3 data/taxi.sqlite3 ".backup backup_$(date +%Y%m%d).sqlite3"

# –ê–±–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ñ–∞–π–ª
cp data/taxi.sqlite3 data/taxi_backup_$(date +%Y%m%d).sqlite3

# –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤ SQL
sqlite3 data/taxi.sqlite3 .dump > backup_$(date +%Y%m%d).sql

# –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—é
sqlite3 data/taxi.sqlite3 "SELECT * FROM orders" > orders_backup.csv
```

---

### –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ backup

#### PostgreSQL

```bash
# –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ dump —Ñ–∞–π–ª—É
pg_restore -h dpg-xxxxx.oregon-postgres.render.com \
           -U taxi_bot_user \
           -d taxi_bot \
           -c \
           backup_20251019.dump

# –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ SQL —Ñ–∞–π–ª—É
psql -h dpg-xxxxx.oregon-postgres.render.com \
     -U taxi_bot_user \
     -d taxi_bot \
     -f backup_20251019.sql
```

#### SQLite

```bash
# –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ backup —Ñ–∞–π–ª—É
cp data/taxi_backup_20251019.sqlite3 data/taxi.sqlite3

# –ê–±–æ –∑ SQL —Ñ–∞–π–ª—É
sqlite3 data/taxi.sqlite3 < backup_20251019.sql
```

---

## üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

### –î–ª—è production (Render PostgreSQL):

1. ‚úÖ **–ó–∞–≤–∂–¥–∏ —Ä–æ–±—ñ—Ç—å backup** –ø–µ—Ä–µ–¥ –º–∞—Å–æ–≤–∏–º–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º–∏
2. ‚úÖ **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ DBeaver** –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è
3. ‚úÖ **–î–æ–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –æ—á–∏—â–µ–Ω–Ω—è** –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å –±–æ—Ç–∞
4. ‚úÖ **–í–∏–¥–∞–ª—è–π—Ç–µ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ —Ä–µ–≥—É–ª—è—Ä–Ω–æ** (>30 –¥–Ω—ñ–≤)
5. ‚úÖ **–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∑–∞–ø–∏—Ç–∏** —Å–ø–æ—á–∞—Ç–∫—É –∑ `SELECT` –ø–µ—Ä–µ–¥ `DELETE`

### –î–ª—è development (–ª–æ–∫–∞–ª—å–Ω–∏–π SQLite):

1. ‚úÖ **–ú–æ–∂–Ω–∞ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞—Ç–∏** - –ª–µ–≥–∫–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏
2. ‚úÖ **–†–æ–±—ñ—Ç—å –∫–æ–ø—ñ—é —Ñ–∞–π–ª—É** –ø–µ—Ä–µ–¥ –≤–µ–ª–∏–∫–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏
3. ‚úÖ **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ sqlite3** CLI –¥–ª—è —à–≤–∏–¥–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

---

## ‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

### –ù–ï –†–û–ë–Ü–¢–¨:

‚ùå **DROP DATABASE** - –≤–∏–¥–∞–ª–∏—Ç—å –≤—Å—é –±–∞–∑—É  
‚ùå **DELETE –±–µ–∑ WHERE** - –≤–∏–¥–∞–ª–∏—Ç—å –≤—Å—ñ –∑–∞–ø–∏—Å–∏  
‚ùå **TRUNCATE –±–µ–∑ backup** - –æ—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—é  
‚ùå **–í–∏–¥–∞–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å** - –∑–ª–∞–º–∞—î –±–æ—Ç–∞  

### –ó–ê–í–ñ–î–ò:

‚úÖ –†–æ–±—ñ—Ç—å backup –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º  
‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `WHERE` –≤ `DELETE` –∑–∞–ø–∏—Ç–∞—Ö  
‚úÖ –°–ø–æ—á–∞—Ç–∫—É `SELECT`, –ø–æ—Ç—ñ–º `DELETE`  
‚úÖ –¢–µ—Å—Ç—É–π—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ñ–π –∫–æ–ø—ñ—ó  

---

## üéØ –ü—Ä–∏–∫–ª–∞–¥–∏ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –û—á–∏—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

```sql
-- 1. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å —Å–∫—ñ–ª—å–∫–∏ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ
SELECT COUNT(*) FROM orders 
WHERE created_at < NOW() - INTERVAL '30 days';

-- 2. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å —è–∫—ñ —Å–∞–º–µ
SELECT id, user_id, status, created_at FROM orders 
WHERE created_at < NOW() - INTERVAL '30 days'
LIMIT 10;

-- 3. –í–∏–¥–∞–ª–∏—Ç–∏
DELETE FROM orders 
WHERE created_at < NOW() - INTERVAL '30 days';

-- 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
SELECT COUNT(*) FROM orders;
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

```sql
-- 1. –ó–Ω–∞–π—Ç–∏ ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
SELECT user_id, full_name, phone FROM users 
WHERE phone LIKE '%test%';

-- 2. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å –π–æ–≥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
SELECT * FROM orders WHERE user_id = 123456789;

-- 3. –í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
DELETE FROM orders WHERE user_id = 123456789;

-- 4. –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
DELETE FROM users WHERE user_id = 123456789;
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –°–∫–∏–Ω—É—Ç–∏ –±–∞–∑—É –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ä—Ç—É

```sql
-- ‚ö†Ô∏è –í–ò–î–ê–õ–ò–¢–¨ –í–°–Ü –î–ê–ù–Ü!

-- 1. –ó—Ä–æ–±–∏—Ç–∏ backup!
-- (–∫–æ–º–∞–Ω–¥–∏ –≤–∏—â–µ)

-- 2. –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ
DELETE FROM orders;
DELETE FROM drivers;
DELETE FROM users;
DELETE FROM ratings;
DELETE FROM payments;
-- ... —ñ–Ω—à—ñ —Ç–∞–±–ª–∏—Ü—ñ

-- 3. –°–∫–∏–Ω—É—Ç–∏ auto-increment (PostgreSQL)
ALTER SEQUENCE orders_id_seq RESTART WITH 1;
ALTER SEQUENCE drivers_id_seq RESTART WITH 1;

-- SQLite
DELETE FROM sqlite_sequence;
```

---

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

**–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞:**

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ —É –≤–∞—Å —î backup
2. –°–ø–æ—á–∞—Ç–∫—É —Ç–µ—Å—Ç—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ (SQLite)
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `SELECT` –ø–µ—Ä–µ–¥ `DELETE`
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å SQL –¥–ª—è –≤–∞—à–æ—ó –ë–î (PostgreSQL vs SQLite)

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫

### –ù–∞–π–∫—Ä–∞—â—ñ –º–µ—Ç–æ–¥–∏:

1. **–î–ª—è —à–≤–∏–¥–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π:** –ö–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ (psql/sqlite3)
2. **–î–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ:** DBeaver
3. **–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó:** –ö–æ–¥ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ –±–æ—Ç–∞
4. **–î–ª—è –±–µ–∑–ø–µ–∫–∏:** –ó–∞–≤–∂–¥–∏ backup + SELECT –ø–µ—Ä–µ–¥ DELETE

**–£—Å–ø—ñ—Ö—ñ–≤ —É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—ñ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö! üöÄ**
